<!--moments.wxml-->
<!-- 通用导航栏组件 -->
<common-navbar title="朋友圈背景" bind:back="onBack"></common-navbar>

<!-- 壁纸预览组件 -->
<wallpaper-preview 
  showPreview="{{showPreview}}"
  currentPreviewWallpaper="{{currentPreviewWallpaper}}"
  previewNavTop="{{previewNavTop}}"
  currentTime="{{currentTime}}"
  currentDate="{{currentDate}}"
  bind:closePreview="onClosePreview"
  bind:downloadWallpaper="downloadWallpaper"
></wallpaper-preview>

<!-- 内容区域 -->
<view class="content-section" style="padding-top: {{contentTop ? contentTop + 'px' : '40px'}};">
  <!-- 朋友圈背景内容 -->
  <view class="moments-content">
    <!-- 类型选择 -->
    <view class="type-section" style="top: {{typeSectionTop}}px;">
      <view class="type-tabs">
        <view 
          wx:for="{{types}}" 
          wx:key="id"
          class="category-tab {{item.active ? 'active' : ''}}"
          bindtap="onTypeClick"
          data-type="{{item.id}}"
        >
          {{item.name}}
        </view>
      </view>
    </view>
    
    <!-- 壁纸展示 -->
    <view class="wallpaper-section">
      <view class="wallpaper-grid">
        <view 
          class="wallpaper-item" 
          wx:for="{{wallpapers}}" 
          wx:key="id"
        >
          <image class="wallpaper-image" src="{{item.image}}" mode="aspectFill" bindtap="previewWallpaper" data-wallpaper="{{item}}"></image>
        </view>
        
        <!-- 空状态 -->
        <view class="empty-state" wx:if="{{wallpapers.length === 0}}">
          <text class="empty-icon">🖼️</text>
          <text class="empty-text">暂无壁纸</text>
          <text class="empty-desc">请稍后重试</text>
        </view>
        
        <!-- 加载更多指示器 -->
        <view class="load-more-container" wx:if="{{loading && wallpapers.length > 0}}">
          <view class="loading-spinner"></view>
          <text class="loading-text">加载中...</text>
        </view>
        
        <!-- 没有更多数据提示 -->
        <view class="no-more-container" wx:if="{{!loading && page >= totalPages && wallpapers.length > 0}}">
          <text class="no-more-text">已经到底了</text>
        </view>
      </view>
    </view>
  </view>
</view>