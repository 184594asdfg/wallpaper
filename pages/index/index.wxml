<!--index.wxml-->
<!-- 自定义导航栏 -->
<view class="custom-nav-bar" style="height: {{navBarHeight}}px; top: {{navBarTop}}px;">
  <!-- 左侧分享区域 -->
  <view class="nav-left">
    <view class="share-btn" bindtap="onShare">
      <text class="share-icon">📤</text>
      <text class="share-text">分享</text>
    </view>
  </view>
  
  <!-- 中间搜索框 -->
    <view class="nav-center">
      <view class="search-box" style="width: {{searchBoxWidth}}px;">
        <text class="search-placeholder">搜索壁纸</text>
      </view>
    </view>
  
  <!-- 右侧预留空间（胶囊按钮） -->
  <view class="nav-right"></view>
</view>

<!-- 内容区域 -->
<view class="content-section">
  <!-- 轮播图区域 -->
  <view class="carousel-section" style="margin-top: {{categoryTop ? categoryTop + 'px' : '40rpx'}}">
    <swiper class="carousel-swiper" indicator-dots circular autoplay interval="3000">
      <swiper-item wx:for="{{carouselList}}" wx:key="id">
        <view class="carousel-item" style="background-color: {{item.bgColor}}"></view>
      </swiper-item>
    </swiper>
  </view>
  
  <!-- 功能区域 -->
  <view class="feature-section">
    <view class="feature-item" bindtap="onFeatureClick" data-type="chat">
      <view class="feature-avatar" style="background-color: #3498db;"></view>
      <text class="feature-text">聊天背景</text>
    </view>
    <view class="feature-item" bindtap="onFeatureClick" data-type="avatar">
      <view class="feature-avatar" style="background-color: #2ecc71;"></view>
      <text class="feature-text">头像</text>
    </view>
    <view class="feature-item" bindtap="onFeatureClick" data-type="emoji">
      <view class="feature-avatar" style="background-color: #f39c12;"></view>
      <text class="feature-text">表情</text>
    </view>
    <view class="feature-item" bindtap="onFeatureClick" data-type="挂件">
      <view class="feature-avatar" style="background-color: #9b59b6;"></view>
      <text class="feature-text">头像挂件</text>
    </view>
  </view>
  
  <!-- 分类区域 - 极简标签式导航设计 -->
  <view class="category-section">
    <view class="category-tabs">
      <view 
        wx:for="{{categories}}" 
        wx:key="id"
        class="category-tab {{item.active ? 'active' : ''}}"
        data-category="{{item.value}}"
        bindtap="onCategoryClick"
      >
        {{item.name}}
      </view>
    </view>
  </view>

  <!-- 壁纸网格 -->
  <view class="covers-section">
    <view class="covers-grid">
      <view 
        class="cover-item" 
        wx:for="{{wallpapers}}" 
        wx:key="id"
      >
        <view class="cover-image-container">
          <image class="cover-image" src="{{item.image}}" mode="aspectFill" bindtap="previewWallpaper" data-wallpaper="{{item}}" lazy-load="true"></image>
        </view>
      </view>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{wallpapers.length === 0}}">
      <text class="empty-icon">🖼️</text>
      <text class="empty-text">暂无壁纸</text>
      <text class="empty-desc">尝试切换分类</text>
    </view>
  </view>
</view>

<!-- 壁纸预览模态框 -->
<view class="wallpaper-preview-modal" wx:if="{{showPreview}}" catchtouchmove="preventTouchMove">
  <!-- 半透明黑色遮罩层 -->
  <view class="preview-mask" catchtouchmove="preventTouchMove"></view>
  
  <!-- 预览内容区域 -->
  <view class="preview-content" catchtouchmove="preventTouchMove">

    <!-- 预览界面返回容器 -->
    <view class="preview-return-navbar" style="top: {{previewNavTop}}px;">
      <!-- 左边返回按钮 -->
      <view class="nav-button left-button" catchtap="onClosePreview">
        <text class="nav-icon">←</text>
      </view>
    </view>
    
    <!-- 时间和日期显示 -->
    <view class="preview-time-date" style="top: {{timeDateHeight}}px; height: {{timeDateHeight}}px;">
      <text class="preview-time">{{currentTime}}</text>
      <text class="preview-date">{{currentDate}}</text>
    </view>
    
    <!-- 壁纸展示区域 -->
    <view class="wallpaper-container">
      <view class="wallpaper-wrapper">
        <!-- 底部下载按钮 -->
        <view class="preview-footer">
          <button class="download-btn" bindtap="downloadWallpaper">
            <text class="download-icon">⬇️</text>
            <text class="download-text">立即下载</text>
          </button>
        </view>
        
        <image 
          class="wallpaper-image" 
          src="{{currentPreviewWallpaper.image}}" 
          mode="aspectFill"
        ></image>
      </view>
    </view>
  </view>
</view>