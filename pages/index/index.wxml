<!--index.wxml-->
<!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
<view class="custom-nav-bar">
  <text class="nav-title">å£çº¸å°ç¨‹åº</text>
</view>

<!-- å†…å®¹åŒºåŸŸ -->
<view class="content-section">
  <!-- åˆ†ç±»åŒºåŸŸ - æç®€æ ‡ç­¾å¼å¯¼èˆªè®¾è®¡ -->
  <view class="category-section" style="margin-top: {{categoryTop ? categoryTop + 'px' : '40rpx'}}">
    <view class="category-tabs">
      <view 
        wx:for="{{categories}}" 
        wx:key="id"
        class="category-tab {{item.active ? 'active' : ''}}"
        data-category="{{item.value}}"
        bindtap="onCategoryClick"
      >
        {{item.name}}
      </view>
    </view>
  </view>

  <!-- å£çº¸ç½‘æ ¼ -->
  <view class="covers-section">
    <view class="covers-grid">
      <view 
        class="cover-item" 
        wx:for="{{wallpapers}}" 
        wx:key="id"
      >
        <view class="cover-image-container">
          <image class="cover-image" src="{{item.image}}" mode="aspectFill" bindtap="previewWallpaper" data-wallpaper="{{item}}" lazy-load="true"></image>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{wallpapers.length === 0}}">
      <text class="empty-icon">ğŸ–¼ï¸</text>
      <text class="empty-text">æš‚æ— å£çº¸</text>
      <text class="empty-desc">å°è¯•åˆ‡æ¢åˆ†ç±»</text>
    </view>
  </view>
</view>

<!-- å£çº¸é¢„è§ˆæ¨¡æ€æ¡† -->
<view class="wallpaper-preview-modal" wx:if="{{showPreview}}" catchtouchmove="preventTouchMove">
  <!-- åŠé€æ˜é»‘è‰²é®ç½©å±‚ -->
  <view class="preview-mask" catchtouchmove="preventTouchMove"></view>
  
  <!-- é¢„è§ˆå†…å®¹åŒºåŸŸ -->
  <view class="preview-content" catchtouchmove="preventTouchMove">

    <!-- é¢„è§ˆç•Œé¢è¿”å›å®¹å™¨ -->
    <view class="preview-return-navbar" style="top: {{previewNavTop}}px;">
      <!-- å·¦è¾¹è¿”å›æŒ‰é’® -->
      <view class="nav-button left-button" catchtap="onClosePreview">
        <text class="nav-icon">â†</text>
      </view>
    </view>
    
    <!-- æ—¶é—´å’Œæ—¥æœŸæ˜¾ç¤º -->
    <view class="preview-time-date" style="top: {{previewNavTop + 40}}px;">
      <text class="preview-time">{{currentTime}}</text>
      <text class="preview-date">{{currentDate}}</text>
    </view>
    
    <!-- å£çº¸å±•ç¤ºåŒºåŸŸ -->
    <view class="wallpaper-container">
      <view class="wallpaper-wrapper">
        <!-- åº•éƒ¨ä¸‹è½½æŒ‰é’® -->
        <view class="preview-footer">
          <button class="download-btn" bindtap="downloadWallpaper">
            <text class="download-icon">â¬‡ï¸</text>
            <text class="download-text">ç«‹å³ä¸‹è½½</text>
          </button>
        </view>
        
        <image 
          class="wallpaper-image" 
          src="{{currentPreviewWallpaper.image}}" 
          mode="aspectFill"
        ></image>
      </view>
    </view>
  </view>
</view>