<!--index.wxml-->
<!-- 导航栏容器 -->
<view class="nav-container"></view>

<!-- 自定义导航栏 -->
<view class="custom-nav-bar" style="height: {{navBarHeight}}px; top: {{navBarTop}}px;">
  <!-- 左侧分享区域 -->
  <view class="nav-left">
    <view class="share-btn" bindtap="onShare">
      <text class="share-icon">📤</text>
      <text class="share-text">分享</text>
    </view>
  </view>
  
  <!-- 中间搜索框 -->
    <view class="nav-center">
      <view class="search-box" style="width: {{searchBoxWidth}}px;" bindtap="onSearchClick">
        <text class="search-placeholder">搜索壁纸</text>
      </view>
    </view>
  
  <!-- 右侧预留空间（胶囊按钮） -->
  <view class="nav-right"></view>
</view>

<!-- 内容区域 -->
<view class="content-section">
  <!-- 轮播图区域 -->
  <view class="carousel-section" style="margin-top: {{categoryTop ? categoryTop + 'px' : '80rpx'}}">
    <swiper class="carousel-swiper" indicator-dots circular autoplay interval="3000">
      <swiper-item wx:for="{{carouselList}}" wx:key="id">
        <image class="carousel-image" src="{{item.image}}" mode="aspectFill" bindtap="onCarouselClick" data-link="{{item.link}}"></image>
        <view class="carousel-title">{{item.title}}</view>
      </swiper-item>
    </swiper>
  </view>
  
  <!-- 功能区域 -->
  <view class="feature-section">
    <view class="feature-item" bindtap="onFeatureClick" data-type="chat">
      <image class="feature-icon" src="../../images/icons/chat.png" mode="aspectFill"></image>
      <text class="feature-text">聊天背景</text>
    </view>
    <view class="feature-item" bindtap="onFeatureClick" data-type="avatar">
      <image class="feature-icon" src="../../images/icons/avatar.png" mode="aspectFill"></image>
      <text class="feature-text">头像</text>
    </view>
    <view class="feature-item" bindtap="onFeatureClick" data-type="emoji">
      <image class="feature-icon" src="../../images/icons/emoji.png" mode="aspectFill"></image>
      <text class="feature-text">表情</text>
    </view>
    <view class="feature-item" bindtap="onFeatureClick" data-type="moments">
      <image class="feature-icon" src="../../images/icons/moments.png" mode="aspectFill"></image>
      <text class="feature-text">朋友圈背景</text>
    </view>
  </view>
  
  <!-- 分类区域 - 极简标签式导航设计 -->
  <view class="category-section" style="top: {{categoryStickyTop}}px;">
    <view class="category-tabs">
      <view 
        wx:for="{{categories}}" 
        wx:key="id"
        class="category-tab {{item.active ? 'active' : ''}}"
        data-category="{{item.value}}"
        bindtap="onCategoryClick"
      >
        {{item.name}}
      </view>
    </view>
  </view>

  <!-- 壁纸网格 -->
  <view class="covers-section">
    <view class="covers-grid">
      <view 
        class="cover-item" 
        wx:for="{{wallpapers}}" 
        wx:key="id"
      >
        <view class="cover-image-container">
          <image class="cover-image" src="{{item.image}}" mode="aspectFill" bindtap="previewWallpaper" data-wallpaper="{{item}}" lazy-load="true"></image>
        </view>
      </view>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{wallpapers.length === 0}}">
      <text class="empty-icon">🖼️</text>
      <text class="empty-text">暂无壁纸</text>
      <text class="empty-desc">尝试切换分类</text>
    </view>
    
    <!-- 加载更多指示器 -->
    <view class="load-more-container" wx:if="{{loading && wallpapers.length > 0}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">加载中...</text>
    </view>
    
    <!-- 没有更多数据提示 -->
    <view class="no-more-container" wx:if="{{!loading && page >= totalPages && wallpapers.length > 0}}">
      <text class="no-more-text">已经到底了</text>
    </view>
  </view>
  
  <!-- 底部导航栏 -->
  <view class="bottom-nav">
    <view class="nav-item active" bindtap="onNavChange" data-index="0">
      <text class="nav-icon">🏠</text>
      <text class="nav-text">精选</text>
    </view>
    <view class="nav-item" bindtap="onNavChange" data-index="1">
      <text class="nav-icon">🔍</text>
      <text class="nav-text">搜索</text>
    </view>
    <view class="nav-item" bindtap="onNavChange" data-index="2">
      <text class="nav-icon">👤</text>
      <text class="nav-text">我的</text>
    </view>
  </view>
</view>

<!-- 壁纸预览组件 -->
<wallpaper-preview 
  showPreview="{{showPreview}}"
  currentPreviewWallpaper="{{currentPreviewWallpaper}}"
  previewNavTop="{{previewNavTop}}"
  currentTime="{{currentTime}}"
  currentDate="{{currentDate}}"
  bind:closePreview="onClosePreview"
  bind:downloadWallpaper="downloadWallpaper"
></wallpaper-preview>